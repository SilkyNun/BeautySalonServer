# BeautySalonServer
Server side of beauty salon application

Paths:

### =====================Мастера============================

**[GET]** `/masters` - выводит всех мастеров в формате:

        "id": 1,
        "name": "Никифоров Денис",
        "tel": "80(29)840-32-32",
        "percent": 0.20,
        "createdAt": "2022-01-08 11:10",
        "updatedAt": "2022-01-08 11:10"
        
**[GET]** `/masters/sorted[?type=percent]` - возвращает всех мастеров, отсортированных по проценту в порядке убывания

**[GET]** `/masters/sorted/?type=date` - возвращает всех мастеров, отсортированных до дате регистрации в порядке убывания (от самого нового до самого старого)
 
        
**[POST]** `/masters` - добавляет нового мастера. В теле запроса надо указать данные по такому шаблону:

        "name": "Никифоров Денис", // не должно быть пустое
        "tel": "80(29)840-32-32", // должно соответствовать шаблону +375(##)###-##-## или 80(##)###-##-##
        "percent": 0.20 // должно быть не меньше 0.00 и не больше 1.00
        
Если валидация прошла неуспешно, то возвращается сообщение об ошибки с кодом ***406 [Not Acceptable]***
     
**[PUT]** `/masters` - изменяет уже существующего мастера. В теле запроса надо указать id мастера и тот параметр, который надо изменить. Напимер:


    "id": 1,
    "name": "Some name"


**[DELETE]** `/masters` - удаляет мастера. Для удаления в теле запроса достаточно указать id мастера. Например:


    "id": 1


**[GET]** `/masters/{id}` - достает мастера с заданным id.

### =====================Клиенты============================

**[GET]** `/clients` - выводит всех клиентов в формате:

        "id": 1,
        "name": "Вероника",
        "tel": "+375(29)840-32-32"

        
**[POST]** `/clients` - добавляет нового клиента. В теле запроса надо указать данные по такому шаблону:

        "name": "Вероника", // не должно быть пустое
        "tel": "+375(29)840-32-32" // должно соответствовать шаблону +375(##)###-##-## или 80(##)###-##-##
        
Если валидация прошла неуспешно, то возвращается сообщение об ошибки с кодом ***406 [Not Acceptable]***     

**[PUT]** `/clients` - изменяет уже существующего клиента. В теле запроса надо указать id клиента и тот параметр, который надо изменить. Напимер:


    "id": 3,
    "name": "Denis"


**[DELETE]** `/clients` - удаляет клиента. Для удаления в теле запроса достаточно указать id клиента. Например:


    "id": 3


**[GET]** `/clients/{id}` - достает клиента с заданным id.


### =====================Заказы============================

**[GET]** `/orders` - выводит все заказы в формате:

        "id": 1,
        "price": 120.00,
        "start": "2022-01-12 14:00",
        "finish": "2022-01-12 14:40",
        "master": {
            "id": 1,
            "name": "Никифоров Денис",
            "tel": "80(29)840-32-32",
            "percent": 0.20,
            "createdAt": "2022-01-08 11:10",
            "updatedAt": "2022-01-08 11:10"
        },
        "client": {
            "id": 1,
            "name": "Вероника",
            "tel": "+375(29)840-32-32"
        }

**[GET]** `/orders/sorted` - возвращает все заказы отсортированные по шаблону:

        "title": "14 января",
        "data": [
            {
                "id": 5,
                "price": 120.00,
                "start": "2022-01-14 10:00",
                "finish": "2022-01-14 10:40",
                "master": {
                    "id": 1,
                    "name": "Никифоров Денис",
                    "tel": "80(29)840-32-32",
                    "percent": 0.20,
                    "createdAt": "2022-01-08 11:10",
                    "updatedAt": "2022-01-08 11:10"
                },
                "client": {
                    "id": 1,
                    "name": "Вероника",
                    "tel": "+375(29)840-32-32"
                }
            }
        ]

**[POST]** `/orders` - добавляет новый заказ. В теле запроса надо указать данные по такому шаблону:

        "price": 2000.00, // не должно быть меньше нуля
        "start": "2021-12-25T14:00:00.000+00:00", // должно содержать будущую или текущую дату
        "finish": "2021-12-25T14:40:00.000+00:00", // должно содержать будущую или текущую дату
        "masterId": 1,
        "clientId": 3
        
Если валидация прошла неуспешно, то возвращается сообщение об ошибки с кодом ***406 [Not Acceptable]***
     
**[PUT]** `/orders` - изменяет уже существующий заказ. В теле запроса надо указать id заказа и тот параметр, который надо изменить. Напимер:


    "id": 2,
    "price": 230.50


**[DELETE]** `/orders` - удаляет заказ. Для удаления в теле запроса достаточно указать id заказа. Например:


    "id": 2


**[GET]** `/orders/{id}` - достает заказ с заданным id.



### =====================Статистика============================


**[GET]** `/statistics/masters` - возвращает статистику всех мастеров, отсортированных по имени (в алфавитном порядке):
     
     {
        "id": 3,
        "name": "Бенгальский Федор",
        "tel": "80(29)379-28-01",
        "percent": 0.30,
        "todayNetIncome": 0.00,
        "monthNetIncome": 60.00
    },
    {
        "id": 4,
        "name": "Елена Метельская",
        "tel": "375(44)998-99-99",
        "percent": 0.08,
        "todayNetIncome": 0.00,
        "monthNetIncome": 0.00
    },
    {
        "id": 2,
        "name": "Лохмаков Максим",
        "tel": "80(29)345-99-18",
        "percent": 0.25,
        "todayNetIncome": 0.00,
        "monthNetIncome": 20.00
    }
    
**[GET]** `/statistics/masters/{id}` - возвращает статистику мастера с id=`{id}`:

    "id": 3,
    "name": "Бенгальский Федор",
    "tel": "80(29)379-28-01",
    "percent": 0.30,
    "todayNetIncome": 0.00,
    "monthNetIncome": 60.00
    
**[GET]** `/statistics/day` - возвращает общую сумму заработка салона за день и статистику мастеров, отсортированных по заработку за день (в порядке убывания):

       "income": 0.0,
       "masters": [
        {
            "id": 1,
            "name": "Никифоров Денис",
            "tel": "80(29)840-32-32",
            "percent": 0.02,
            "todayNetIncome": 0.0,
            "monthNetIncome": 4.8
        },
        {
            "id": 2,
            "name": "Лохмаков Максим",
            "tel": "80(29)345-99-18",
            "percent": 0.25,
            "todayNetIncome": 0.0,
            "monthNetIncome": 20.0
        }]
       
**[GET]** `/statistics/month` - возвращает общую сумму заработка салона за месяц и статистику мастеров, отсортированных по заработку за месяц (в порядке убывания):       

       "income": 520.0,
       "masters": [
        {
            "id": 3,
            "name": "Бенгальский Федор",
            "tel": "80(29)379-28-01",
            "percent": 0.30,
            "todayNetIncome": 0.0,
            "monthNetIncome": 60.0
        },
        {
            "id": 2,
            "name": "Лохмаков Максим",
            "tel": "80(29)345-99-18",
            "percent": 0.25,
            "todayNetIncome": 0.0,
            "monthNetIncome": 20.0
        },
        {
            "id": 1,
            "name": "Никифоров Денис",
            "tel": "80(29)840-32-32",
            "percent": 0.02,
            "todayNetIncome": 0.0,
            "monthNetIncome": 4.8
        }]
